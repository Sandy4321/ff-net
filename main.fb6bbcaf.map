{"version":3,"sources":["js/svg.js","js/math.js","js/Color.js","js/Neuron.js","js/Link.js","js/Layer.js","js/NeuralNet.js","js/DataPoint.js","js/DataCanvas.js","js/ErrorPlot.js","js/ControlPanel.js","js/data.js","js/main.js"],"names":["svg","createElement","element","document","createElementNS","module","exports","math","roundToString","n","decimalDigits","factor","i","str","Math","round","toString","dotPosition","indexOf","length","sigmoid","exp","dSigmoid","Color","r","g","b","a","WHITE","BLACK","RED","BLUE","LIGHT_BLUE","LIGHT_RED","p","prototype","blend","c","t","abs","source","target","floor","require","radius","strokeWidth","Neuron","layer","bias","links","backLinks","preActivation","activation","dActivation","dPreActivation","dBias","isInput","isOutput","svgElement","setAttribute","redraw","circle","position","getPosition","x","y","maxVisibleBias","tFillColor","fillColor","strokeColor","getIndex","neurons","neuralNet","neuronCount","layerCount","layers","maxNeuronCountPerLayer","container","parentNode","containerRect","getBoundingClientRect","width","height","cy","cx","dx","dy","forward","link","weight","n0","backward","regularization","regularizationError","dWeight","applyGradient","learningRate","reset","newFromData","data","addNeuron","toData","Link","nf","path","p0","pf","maxVisibleWeight","min","color","addLink","Layer","neuron","push","svgNeurons","appendChild","getNeuronAt","getNeuronCount","addLayer","neuronData","NeuralNet","svgLinks","addFullyConnectedLayer","l0","lf","j","input","randomizeParameters","random","layerData","linkData","DataPoint","canvas","label","ctx","domElement","beginPath","fillStyle","strokeStyle","arc","PI","fill","stroke","DataCanvas","dataPoints","getContext","pixelColors","setUpDragBehavior","addDataPoint","classify","canvasWidth","canvasHeight","fWidth","fHeight","canvasImageData","getImageData","clearRect","ii","jj","putImageData","dataPoint","computeCursor","event","rect","clientX","clientY","touches","left","top","cursor","dragState","handleDragBegin","bind","addEventListener","handleDragProgress","window","handleDragEnd","preventDefault","offset","dataCanvas","item","minTopError","ErrorPlot","id","maxDataLength","topError","getMaxTotalError","max","totalError","update","dataError","shift","maxTotalError","moveTo","lineTo","ControlPanel","controllableParameters","div","className","rows","rowsByLabel","row","addRow","btnRandomize","innerHTML","cells","control","value","errorPlot","addCell","cell","type","controlPanel","init","body","svgNeuralNet","output","d","requestAnimationFrame","getData"],"mappings":"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","file":"main.fb6bbcaf.map","sourceRoot":"..","sourcesContent":["var svg = {};\n\nsvg.createElement = function(element) {\n\treturn document.createElementNS(\"http://www.w3.org/2000/svg\", element);\n}\n\nmodule.exports = svg;\n","var math = {};\n\nmath.roundToString = function(n, decimalDigits) {\n\tvar factor = 1;\n\tfor (var i = 0; i < decimalDigits; i++) {\n\t\tfactor *= 10;\n\t}\n\tvar str = (Math.round(n * factor) / factor).toString();\n\t\n\tif (decimalDigits == 0) return str;\n\t\n\tvar dotPosition = str.indexOf(\".\");\n\tif (dotPosition === -1) {\n\t\tdotPosition = str.length;\n\t\tstr += \".0\";\n\t}\n\tfor (var i = str.length - dotPosition - 1; i < decimalDigits; i++) {\n\t\tstr += \"0\";\n\t}\n\treturn str;\n}\n\nmath.sigmoid = function(n) {\n\treturn 1 / (1 + Math.exp(-n));\n}\n\nmath.dSigmoid = function(n) {\n\treturn math.sigmoid(n) * (1 - math.sigmoid(n));\n}\n\nmodule.exports = math;","// r, g, b, a are numbers between 0 and 1\nvar Color = function(r, g, b, a) {\n\tif (a == null) a = 1;\n\tthis.r = r;\n\tthis.g = g;\n\tthis.b = b;\n\tthis.a = a;\n}\n\nColor.WHITE = new Color(1, 1, 1);\nColor.BLACK = new Color(0, 0, 0);\n\nColor.RED = new Color(226 / 255, 86 / 255, 86 / 255);\nColor.BLUE = new Color(135 / 255, 173 / 255, 236 / 255);\n\nColor.LIGHT_BLUE = new Color(186 / 255, 224 / 255, 251 / 255);\nColor.LIGHT_RED = new Color(252 / 255, 163 / 255, 163 / 255);\n\nvar p = Color.prototype;\n\n// t = 1 means replace this with color c\np.blend = function(c, t) {\n\tif (Math.abs(t) > 1) throw \"t must be a number between -1 and 1\";\n\t\n\tvar source, target;\n\tif (t >= 0) {\n\t\tsource = this;\n\t\ttarget = c;\n\t} else {\n\t\tsource = c;\n\t\ttarget = this;\n\t}\n\t\n\treturn new Color(\n\t\tsource.r * (1 - t) + target.r * t,\n\t\tsource.g * (1 - t) + target.g * t,\n\t\tsource.b * (1 - t) + target.b * t\n\t);\n}\n\np.toString = function() {\n\treturn \"rgba(\" +\n\t\tMath.floor(255 * this.r) + \", \" +\n\t\tMath.floor(255 * this.g) + \", \" +\n\t\tMath.floor(255 * this.b) + \", \" +\n\t\tthis.a\n\t\t+ \")\";\n}\n\nmodule.exports = Color;","var svg = require(\"./svg\");\nvar math = require(\"./math\");\nvar Color = require(\"./Color\");\n\nvar radius = 12;\nvar strokeWidth = 2;\n\nvar Neuron = function(layer, bias) {\n\tthis.layer = layer;\n\tthis.links = [];\n\tthis.backLinks = [];\n\tthis.bias = bias;\n\tthis.preActivation = 0;\n\tthis.activation = math.sigmoid(this.bias);\n\tthis.dActivation = 0;\n\tthis.dPreActivation = 0;\n\tthis.dBias = 0;\n\tthis.isInput = false;\n\tthis.isOutput = false;\n\n\tvar svgElement = this.svgElement = svg.createElement(\"circle\");\n\tsvgElement.setAttribute(\"r\", radius);\n}\n\nvar p = Neuron.prototype;\n\np.redraw = function() {\n\tvar circle = this.svgElement;\n\tvar position = this.getPosition();\n\tcircle.setAttribute(\"cx\", position.x);\n\tcircle.setAttribute(\"cy\", position.y);\n\t\n\tvar maxVisibleBias = 3;\n\tvar bias = this.bias;\n\tvar tFillColor;\n\tif (bias < -maxVisibleBias) bias = -maxVisibleBias;\n\telse if (bias > maxVisibleBias) bias = maxVisibleBias;\n\ttFillColor = (bias / maxVisibleBias + 1) * 0.5;\n\tvar fillColor = Color.RED.blend(Color.BLUE, tFillColor);\n\tvar strokeColor = fillColor.blend(Color.BLACK, 0.3);\n\t\n\tcircle.setAttribute(\"fill\", fillColor.toString());\n\tcircle.setAttribute(\"stroke\", strokeColor.toString());\n\tcircle.setAttribute(\"stroke-width\", strokeWidth);\n}\n\np.getIndex = function() {\n\treturn this.layer.neurons.indexOf(this);\n}\n\np.getPosition = function() {\n\tvar neuralNet = this.layer.neuralNet;\n\tvar neuronCount = this.layer.neurons.length;\n\tvar layerCount = neuralNet.layers.length;\n\tvar maxNeuronCountPerLayer = 5;\n\t\n\tvar container = neuralNet.svgElement.parentNode;\n\tif (container == null) return {x: 0, y: 0};\n\tvar containerRect = container.getBoundingClientRect();\n\tvar width = containerRect.width;\n\tvar height = containerRect.height;\n\t\n\tvar cy = height / 2;\n\tvar cx = width / 2;\n\t\n\tvar dx = (width - (radius + strokeWidth) * 2) / (layerCount - 1);\n\tvar dy = (height - (radius + strokeWidth) * 2) / (maxNeuronCountPerLayer - 1);\n\t\n\tvar x = cx + (this.layer.getIndex() - (layerCount - 1) / 2) * dx;\n\t\n\tvar y;\n\tif (neuronCount == 0) {\n\t\ty = cy;\n\t} else {\n\t\ty = cy + (this.getIndex() - (neuronCount - 1) / 2) * dy;\n\t}\n\t\n\treturn {\n\t\tx: x,\n\t\ty: y\n\t};\n}\n\np.forward = function() {\n\tthis.preActivation = 0;\n\tthis.preActivation += this.bias;\n\tfor (var i = 0; i < this.backLinks.length; i++) {\n\t\tvar link = this.backLinks[i];\n\t\tthis.preActivation += link.weight * link.n0.activation;\n\t}\n\tthis.activation = math.sigmoid(this.preActivation);\n}\n\np.backward = function(regularization) {\n\tvar regularizationError = 0;\n\t\n\tfor (var i = 0; i < this.links.length; i++) {\n\t\tvar link = this.links[i];\n\t\tthis.dActivation += link.weight * link.dWeight;\n\t}\n\t\n\tthis.dPreActivation = this.dActivation * math.dSigmoid(this.preActivation);\n\tthis.dBias = this.dPreActivation;\n\t\n\tfor (var i = 0; i < this.backLinks.length; i++) {\n\t\tvar link = this.backLinks[i];\n\t\tregularizationError += link.backward(regularization);\n\t}\n\t\n\treturn regularizationError;\n}\n\np.applyGradient = function(learningRate) {\n\tthis.bias -= learningRate * this.dBias;\n}\n\np.reset = function() {\n\tthis.preActivation = 0;\n\tthis.activation = math.sigmoid(this.bias);\n\tthis.dActivation = 0;\n\tthis.dPreActivation = 0;\n\tthis.dBias = 0;\n}\n\nNeuron.newFromData = function(layer, data) {\n\tlayer.addNeuron(data.bias);\n}\n\np.toData = function() {\n\tvar data = {};\n\tdata.bias = this.bias;\n\treturn data;\n}\n\nmodule.exports = Neuron;\n","var svg = require(\"./svg\");\nvar Color = require(\"./Color\");\n\nvar Link = function(neuralNet, n0, nf, weight) {\n\tthis.neuralNet = neuralNet;\n\tthis.n0 = n0;\n\tthis.nf = nf;\n\t\n\tif (this.n0.layer.getIndex() + 1 != this.nf.layer.getIndex()) {\n\t\tthrow \"Cannot connect neurons from non-consecutive layers\";\n\t}\n\t\n\tif (weight == null) this.weight = 1;\n\telse this.weight = weight;\n\tthis.dWeight = 0;\n\n\tthis.svgElement = svg.createElement(\"path\");\n\tthis.redraw();\n}\n\nvar p = Link.prototype;\n\np.redraw = function() {\n\tvar path = this.svgElement;\n\tvar p0 = this.n0.getPosition();\n\tvar pf = this.nf.getPosition();\n\tpath.setAttribute(\n\t\t\"d\",\n\t\t\"M\" + p0.x + \" \" + p0.y + \" \" +\n\t\t\"L\" + pf.x + \" \" + pf.y\n\t);\n\tvar maxVisibleWeight = 5;\n\tvar width = 9 * Math.min(1, Math.abs(this.weight) / maxVisibleWeight);\n\tpath.setAttribute(\"stroke-width\", width);\n\tvar color;\n\tif (this.weight < 0) color = Color.RED;\n\telse color = Color.BLUE;\n\tpath.setAttribute(\"stroke-opacity\", 0.4);\n\tpath.setAttribute(\"stroke\", color);\n}\n\np.backward = function(regularization) {\n\tvar regularizationError = 0;\n\tthis.dWeight = this.n0.activation * this.nf.dPreActivation;\n\t// regularization error = 0.5 * regularization * weight^2\n\tthis.dWeight += regularization * this.weight;\n\tregularizationError += 0.5 * regularization * this.weight * this.weight;\n\treturn regularizationError;\n}\n\np.applyGradient = function(learningRate) {\n\tthis.weight -= learningRate * this.dWeight;\n}\n\nLink.newFromData = function(neuralNet, data) {\n\tvar weight = data.weight;\n\tvar n0 = neuralNet.layers[data.n0[0]].neurons[data.n0[1]];\n\tvar nf = neuralNet.layers[data.nf[0]].neurons[data.nf[1]];\n\tvar link = neuralNet.addLink(n0, nf, weight);\n\treturn link;\n}\n\np.toData = function() {\n\tvar data = {};\n\tdata.n0 = [\n\t\tthis.n0.layer.getIndex(),\n\t\tthis.n0.getIndex()\n\t];\n\tdata.nf = [\n\t\tthis.nf.layer.getIndex(),\n\t\tthis.nf.getIndex()\n\t];\n\tdata.weight = this.weight;\n\treturn data;\n}\n\nmodule.exports = Link;\n","var svg = require(\"./svg\");\nvar Neuron = require(\"./Neuron\");\n\nvar Layer = function(neuralNet) {\n\tthis.neuralNet = neuralNet;\n\tthis.neurons = [];\n}\n\nvar p = Layer.prototype;\n\np.redraw = function() {\n\tfor (var i = 0; i < this.neurons.length; i++) {\n\t\tvar neuron = this.neurons[i];\n\t\tneuron.redraw();\n\t}\n}\n\np.reset = function() {\n\tfor (var i = 0; i < this.neurons.length; i++) {\n\t\tvar neuron = this.neurons[i];\n\t\tneuron.reset();\n\t}\n}\n\np.addNeuron = function(bias) {\n\tif (bias == null) bias = 0.5;\n\tvar neuron = new Neuron(this, bias);\n\tthis.neurons.push(neuron);\n\tthis.neuralNet.neurons.push(neuron);\n\tthis.neuralNet.svgNeurons.appendChild(neuron.svgElement);\n\treturn neuron;\n}\n\np.getNeuronAt = function(i) {\n\treturn this.neurons[i];\n}\n\np.getNeuronCount = function() {\n\treturn this.neurons.length;\n}\n\np.getIndex = function() {\n\treturn this.neuralNet.layers.indexOf(this);\n}\n\nLayer.newFromData = function(neuralNet, data) {\n\tvar layer = neuralNet.addLayer();\n\tfor (var i = 0; i < data.neurons.length; i++) {\n\t\tvar neuronData = data.neurons[i];\n\t\tNeuron.newFromData(layer, data);\n\t}\n\treturn layer;\n}\n\np.toData = function() {\n\tvar data = {};\n\t\n\tdata.neurons = [];\n\tfor (var i = 0; i < this.neurons.length; i++) {\n\t\tvar neuron = this.neurons[i];\n\t\tdata.neurons.push(neuron.toData());\n\t}\n\t\n\treturn data;\n}\n\nmodule.exports = Layer;\n","var svg = require(\"./svg\");\nvar Neuron = require(\"./Neuron\");\nvar Link = require(\"./Link\");\nvar Layer = require(\"./Layer\");\n\nvar NeuralNet = function() {\n\tthis.neurons = [];\n\tthis.links = [];\n\tthis.layers = [];\n\n\tthis.svgElement = svg.createElement(\"g\");\n\t\n\tthis.svgLinks = svg.createElement(\"g\");\n\tthis.svgElement.appendChild(this.svgLinks);\n\t\n\tthis.svgNeurons = svg.createElement(\"g\");\n\tthis.svgElement.appendChild(this.svgNeurons);\n}\n\nvar p = NeuralNet.prototype;\n\np.addLayer = function(neuronCount) {\n\tif (neuronCount == null) neuronCount = 0;\t\n\t\n\tvar layer = new Layer(this);\n\tthis.layers.push(layer);\n\t\n\tfor (var i = 0; i < neuronCount; i++) {\n\t\tvar neuron = layer.addNeuron();\n\t}\n\t\n\treturn layer;\n}\n\np.addFullyConnectedLayer = function(neuronCount) {\n\tvar l0 = this.layers[this.layers.length - 1];\n\tthis.addLayer(neuronCount);\n\tvar lf = this.layers[this.layers.length - 1];\n\tfor (var i = 0; i < l0.neurons.length; i++) {\n\t\tvar n0 = l0.neurons[i];\n\t\tfor (var j = 0; j < lf.neurons.length; j++) {\n\t\t\tvar nf = lf.neurons[j];\n\t\t\tthis.addLink(n0, nf);\n\t\t}\n\t}\n}\n\np.addLink = function(n0, nf, weight) {\n\tvar link = new Link(this, n0, nf, weight);\n\tn0.links.push(link);\n\tnf.backLinks.push(link);\n\tthis.links.push(link);\n\tthis.svgLinks.appendChild(link.svgElement);\n\treturn link;\n}\n\np.redraw = function() {\n\tfor (var i = 0; i < this.layers.length; i++) {\n\t\tvar layer = this.layers[i];\n\t\tlayer.redraw();\n\t}\n\tfor (var i = 0; i < this.links.length; i++) {\n\t\tvar link = this.links[i];\n\t\tlink.redraw();\n\t}\n}\n\np.reset = function(input) {\n\tfor (var i = 0; i < this.layers.length; i++) {\n\t\tvar layer = this.layers[i];\n\t\tlayer.reset();\n\t}\n}\n\np.randomizeParameters = function() {\n\tfor (var i = 0; i < this.links.length; i++) {\n\t\tvar link = this.links[i];\n\t\tvar weight = 2 + Math.random() * 4;\n\t\tif (Math.random() <= 0.5) weight *= -1;\n\t\tlink.weight = weight;\n\t}\n\t\n\tfor (var i = 0; i < this.neurons.length; i++) {\n\t\tvar neuron = this.neurons[i];\n\t\tvar bias = 1 + Math.random() * 2;\n\t\tif (Math.random() <= 0.5) bias *= -1;\n\t\tneuron.bias = bias;\n\t}\n}\n\np.forward = function(input) {\n\tfor (var i = 1; i < this.layers.length; i++) {\n\t\tvar layer = this.layers[i];\n\t\tfor (var j = 0; j < layer.neurons.length; j++) {\n\t\t\tvar neuron = layer.neurons[j];\n\t\t\tneuron.forward();\n\t\t}\n\t}\n}\n\np.backward = function(learningRate, regularization) {\n\tregularizationError = 0;\n\t\n\tfor (var i = this.layers.length - 1; i >= 0; i--) {\n\t\tvar layer = this.layers[i];\n\t\tfor (var j = 0; j < layer.neurons.length; j++) {\n\t\t\tvar neuron = layer.neurons[j];\n\t\t\tregularizationError += neuron.backward(regularization);\n\t\t}\n\t}\n\t\n\tthis.applyGradient(learningRate);\n\t\n\treturn regularizationError;\n}\n\np.applyGradient = function(learningRate) {\n\tfor (var i = 0; i < this.links.length; i++) {\n\t\tvar link = this.links[i];\n\t\tlink.applyGradient(learningRate);\n\t}\n\t\n\tfor (var i = 1; i < this.layers.length; i++) {\n\t\tvar layer = this.layers[i];\n\t\tfor (var j = 0; j < layer.neurons.length; j++) {\n\t\t\tvar neuron = layer.neurons[j];\n\t\t\tneuron.applyGradient(learningRate);\n\t\t}\n\t}\n}\n\nNeuralNet.newFromData = function(data) {\n\tvar neuralNet = new NeuralNet();\n\t\n\tfor (var i = 0; i < data.layers.length; i++) {\n\t\tvar layerData = data.layers[i];\n\t\tLayer.newFromData(neuralNet, layerData);\n\t}\n\t\n\tfor (var i = 0; i < data.links.length; i++) {\n\t\tvar linkData = data.links[i];\n\t\tLink.newFromData(neuralNet, linkData);\n\t}\n\t\n\treturn neuralNet;\n}\n\np.toData = function() {\n\tvar data = {};\n\t\n\tdata.layers = [];\n\tfor (var i = 0; i < this.layers.length; i++) {\n\t\tvar layer = this.layers[i];\n\t\tdata.layers.push(layer.toData());\n\t}\n\t\n\tdata.links = [];\n\tfor (var i = 0; i < this.links.length; i++) {\n\t\tvar link = this.links[i];\n\t\tdata.links.push(link.toData());\n\t}\n\t\n\treturn data;\n}\n\nmodule.exports = NeuralNet;\n","var Color = require(\"./Color\");\n\nvar DataPoint = function(canvas, x, y, label) {\n\tthis.canvas = canvas;\n\tthis.x = x;\n\tthis.y = y;\n\tthis.label = label;\n\tthis.radius = 5;\n}\n\nvar p = DataPoint.prototype;\n\np.redraw = function() {\n\tvar ctx = this.canvas.ctx;\n\tvar width = this.canvas.domElement.width;\n\tvar height = this.canvas.domElement.height;\n\t\n\tvar fillColor;\n\tif (this.label == 0) fillColor = Color.RED;\n\telse fillColor = Color.BLUE;\n\tvar strokeColor = fillColor.blend(Color.BLACK, 0.6);\n\t\n\tctx.beginPath();\n\tctx.fillStyle = fillColor.toString();\n\tctx.strokeStyle = strokeColor.toString();\n\tctx.arc(\n\t\tthis.x * width, this.y * height,\n\t\tthis.radius,\n\t\t0, 2 * Math.PI\n\t);\n\tctx.fill();\n\tctx.stroke();\n}\n\nmodule.exports = DataPoint;","var Color = require(\"./Color\");\nvar DataPoint = require(\"./DataPoint\");\n\nvar DataCanvas = function() {\n\tthis.dataPoints = [];\n\tvar canvas = this.domElement = document.createElement(\"canvas\");\n\tcanvas.width = 250;\n\tcanvas.height = 250;\n\tthis.ctx = canvas.getContext(\"2d\");\n\n\tthis.width = 50;\n\tthis.height = 50;\n\tthis.pixelColors = [];\n\tfor (var i = 0; i < this.width; i++) {\n\t\tthis.pixelColors.push([]);\n\t\tfor (var j = 0; j < this.height; j++) {\n\t\t\tthis.pixelColors[i].push(0);\n\t\t}\n\t}\n\n\tthis.setUpDragBehavior();\n}\n\nvar p = DataCanvas.prototype;\n\np.addDataPoint = function(x, y, label) {\n\tthis.dataPoints.push(new DataPoint(this, x, y, label));\n}\n\np.redraw = function(classify) {\n\tvar ctx = this.ctx;\n\tvar canvas = this.domElement;\n\tvar canvasWidth = canvas.width;\n\tvar canvasHeight = canvas.height;\n\n\tvar width = this.width;\n\tvar height = this.height;\n\n\tfor (var i = 0; i < width; i++) {\n\t\tfor (var j = 0; j < height; j++) {\n\t\t\tvar label = classify(i / width, j / height);\n\t\t\tvar color = Color.LIGHT_RED.blend(Color.LIGHT_BLUE, label);\n\t\t\tthis.pixelColors[i][j] = color;\n\t\t}\n\t}\n\n\tvar fWidth = canvasWidth / width;\n\tvar fHeight = canvasHeight / height;\n\tvar canvasImageData = ctx.getImageData(0, 0, canvasWidth, canvasHeight);\n\tctx.clearRect(0, 0, canvasWidth, canvasHeight);\n\tfor (var i = 0; i < canvasImageData.data.length / 4; i++) {\n\t\tvar y = Math.floor(i / canvasWidth);\n\t\tvar x = i % canvasWidth;\n\t\tvar ii = Math.floor(x / fWidth);\n\t\tvar jj = Math.floor(y / fHeight);\n\t\tvar color = this.pixelColors[ii][jj];\n\t\tcanvasImageData.data[4 * i] = Math.round(color.r * 255);\n\t\tcanvasImageData.data[4 * i + 1] = Math.round(color.g * 255);\n\t\tcanvasImageData.data[4 * i + 2] = Math.round(color.b * 255);\n\t\tcanvasImageData.data[4 * i + 3] = 255;\n\t}\n\tctx.putImageData(canvasImageData, 0, 0);\n\n\tfor (var i = 0; i < this.dataPoints.length; i++) {\n\t\tvar dataPoint = this.dataPoints[i];\n\t\tdataPoint.redraw();\n\t}\n}\n\np.computeCursor = function(event) {\n\tvar rect = this.domElement.getBoundingClientRect();\n\tvar clientX, clientY;\n\tif (event.touches == null) {\n\t\tclientX = event.clientX;\n\t\tclientY = event.clientY;\n\t} else {\n\t\tclientX = event.touches[0].clientX;\n\t\tclientY = event.touches[0].clientY;\n\t}\n\tvar left = clientX - rect.left;\n\tvar top = clientY - rect.top;\n\tvar cursor = {x: left, y: top};\n\tevent.cursor = cursor;\n}\n\np.setUpDragBehavior = function() {\n\tvar canvas = this.domElement;\n\n\tthis.dragState = null;\n\n\tthis.handleDragBegin = this.handleDragBegin.bind(this);\n\tcanvas.addEventListener(\"touchstart\", this.handleDragBegin);\n\tcanvas.addEventListener(\"mousedown\", this.handleDragBegin);\n\n\tthis.handleDragProgress = this.handleDragProgress.bind(this);\n\twindow.addEventListener(\"mousemove\", this.handleDragProgress);\n\twindow.addEventListener(\"touchmove\", this.handleDragProgress);\n\n\tthis.handleDragEnd = this.handleDragEnd.bind(this);\n\twindow.addEventListener(\"mouseup\", this.handleDragEnd);\n\twindow.addEventListener(\"touchend\", this.handleDragEnd);\n\twindow.addEventListener(\"touchcancel\", this.handleDragEnd);\n}\n\np.handleDragBegin = function(event) {\n\tevent.preventDefault();\n\tthis.computeCursor(event);\n\n\tfor (var i = 0; i < this.dataPoints.length; i++) {\n\t\tvar dataPoint = this.dataPoints[i];\n\n\t\tvar dx = event.cursor.x - dataPoint.x * this.domElement.width;\n\t\tvar dy = event.cursor.y - dataPoint.y * this.domElement.height;\n\n\t\tvar r = dataPoint.radius;\n\n\t\tif (dx * dx + dy * dy <= r * r) {\n\t\t\tthis.dragState = {\n\t\t\t\tdataPoint: dataPoint,\n\t\t\t\toffset: {x: dx, y: dy}\n\t\t\t};\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\np.handleDragProgress = function(event) {\n\tif (this.dragState == null) return;\n\tthis.computeCursor(event);\n\tevent.preventDefault();\n\n\tvar dataPoint = this.dragState.dataPoint;\n\tvar offset = this.dragState.offset;\n\n\tdataPoint.x = (event.cursor.x - offset.x) / this.domElement.width;\n\tdataPoint.y = (event.cursor.y - offset.y) / this.domElement.height;\n\n\tif (dataPoint.x < 0) dataPoint.x = 0;\n\telse if (dataPoint.x > 1) dataPoint.x = 1;\n\tif (dataPoint.y < 0) dataPoint.y = 0;\n\telse if (dataPoint.y > 1) dataPoint.y = 1;\n}\n\np.handleDragEnd = function(event) {\n\tif (this.dragState == null) return;\n\tvar dataPoint = this.dragState.dataPoint;\n\tthis.dragState = null;\n}\n\nDataCanvas.newFromData = function(data) {\n\tvar dataCanvas = new DataCanvas();\n\tfor (var i = 0; i < data.length; i++) {\n\t\tvar item = data[i];\n\t\tdataCanvas.addDataPoint(item.x, item.y, item.label);\n\t}\n\treturn dataCanvas;\n}\n\np.toData = function() {\n\tvar data = [];\n\tfor (var i = 0; i < this.dataPoints.length; i++) {\n\t\tvar dataPoint = this.dataPoints[i];\n\t\tdata.push({\n\t\t\tx: dataPoint.x,\n\t\t\ty: dataPoint.y,\n\t\t\tlabel: dataPoint.label\n\t\t});\n\t}\n\treturn data;\n}\n\nmodule.exports = DataCanvas;\n","var minTopError = 4;\n\nvar ErrorPlot = function() {\t\n\tvar canvas = this.domElement = document.createElement(\"canvas\");\n\tcanvas.id = \"error-canvas\";\n\tthis.ctx = canvas.getContext(\"2d\");\t\n\tthis.maxDataLength = canvas.width;\n\tthis.data = [];\n\tthis.topError = minTopError;\n}\n\nvar p = ErrorPlot.prototype;\n\np.getMaxTotalError = function() {\n\tvar max = 0;\n\tfor (var i = 0; i < this.data.length; i++) {\n\t\tvar item = this.data[i];\n\t\tvar totalError = item.totalError;\n\t\tif (totalError > max) max = totalError;\n\t}\n\treturn max;\n}\n\np.update = function(dataError, regularizationError) {\n\tif (this.data.length == this.maxDataLength) {\n\t\tthis.data.shift();\n\t}\n\tvar totalError = dataError + regularizationError;\n\tthis.data.push({\n\t\tdataError: dataError,\n\t\tregularizationError: regularizationError,\n\t\ttotalError: totalError\n\t});\n\tvar maxTotalError = this.getMaxTotalError();\n\tif (maxTotalError > minTopError) this.topError = maxTotalError;\n\telse this.topError = minTopError;\n\tthis.redraw();\n}\n\np.redraw = function() {\t\n\tvar ctx = this.ctx;\n\tvar width = this.domElement.width;\n\tvar height = this.domElement.height;\n\tctx.clearRect(0, 0, width, height);\n\t\n\tfor (var i = 1; i < this.data.length; i++) {\n\t\tvar item = this.data[i];\n\t\tvar totalError = item.totalError;\n\t\tvar x = i / (this.maxDataLength - 1) * width;\n\t\tvar y = height * (1 - totalError / this.topError);\n\t\tctx.beginPath();\n\t\tctx.strokeStyle = \"rgb(255, 221, 78)\";\n\t\tctx.moveTo(x, height);\n\t\tctx.lineTo(x, y);\n\t\tctx.stroke();\n\t}\n}\n\nmodule.exports = ErrorPlot;","var math = require(\"./math\");\nvar ErrorPlot = require(\"./ErrorPlot\");\n\nvar ControlPanel = function(neuralNet, controllableParameters) {\n\tvar div = this.domElement = document.createElement(\"div\");\n\tdiv.className = \"control-panel\";\n\t\n\tthis.rows = [];\n\tthis.rowsByLabel = {};\n\tvar row;\n\t\n\trow = this.addRow(\"full\");\n\tvar btnRandomize = document.createElement(\"div\");\n\tbtnRandomize.innerHTML = \"randomize network parameters\";\n\tbtnRandomize.className = \"btn\";\n\trow.cells[0].appendChild(btnRandomize);\n\tbtnRandomize.addEventListener(\"click\", function() {\n\t\tneuralNet.randomizeParameters();\n\t});\n\t\n\trow = this.addRow(\"slider\", \"learning rate\");\n\trow.control.min = 1;\n\trow.control.max = 80;\n\trow.control.value = Math.round(controllableParameters.learningRate * 100);\n\trow.control.addEventListener(\"change\", function() {\n\t\tcontrollableParameters.learningRate = this.value / 100;\n\t}.bind(row.control));\n\t\n\trow = this.addRow(\"slider\", \"regularization\");\n\trow.control.min = 0;\n\trow.control.max = 100;\n\trow.control.value = Math.round(controllableParameters.regularization * 1000000);\n\trow.control.addEventListener(\"change\", function() {\n\t\tcontrollableParameters.regularization = this.value / 1000000;\n\t}.bind(row.control));\n\t\n\trow = this.addRow(\"text\", \"error\");\n\trow.control.className = \"formatted-number\";\n\t\t\n\trow = this.addRow(\"full\");\n\tvar errorPlot = this.errorPlot = new ErrorPlot();\n\trow.cells[0].appendChild(errorPlot.domElement);\n}\n\nvar p = ControlPanel.prototype;\n\np.addCell = function(row) {\n\tcell = document.createElement(\"div\");\n\tcell.className = \"control-cell\";\n\trow.appendChild(cell);\n\trow.cells.push(cell);\n\treturn cell;\n}\n\np.addRow = function(type, label) {\n\tvar row = document.createElement(\"div\");\n\trow.cells = [];\n\trow.className = \"control-row\";\n\tthis.domElement.appendChild(row);\n\tthis.rows.push(row);\n\tthis.rowsByLabel[label] = row;\n\t\n\tvar cell;\n\t\n\tif (type == \"full\") {\n\t\tcell = document.createElement(\"div\");\n\t\tcell.className = \"control-cell-full\";\n\t\trow.appendChild(cell);\n\t\trow.cells.push(cell);\n\t} else {\n\t\tcell = this.addCell(row);\n\t\tcell.innerHTML = label;\n\t\t\n\t\tcell = this.addCell(row);\n\t\tvar control;\n\t\tswitch (type) {\n\t\t\tcase \"slider\":\n\t\t\t\tcontrol = document.createElement(\"input\");\n\t\t\t\tcontrol.type = \"range\";\n\t\t\t\tbreak;\n\t\t\tcase \"text\":\n\t\t\t\tcontrol = cell;\n\t\t\t\tbreak;\n\t\t\t\tbreak;\n\t\t}\n\t\tif (control != cell && control != null) cell.appendChild(control);\n\t\t\n\t\trow.control = control;\n\t}\n\t\n\treturn row;\n}\n\np.update = function(data) {\n\tthis.rowsByLabel[\"error\"].control.innerHTML =\n\t\tmath.roundToString(data.totalError, 10);\n\tthis.errorPlot.update(data.dataError, data.regularizationError);\n}\n\nmodule.exports = ControlPanel;\n","module.exports={\"dataPoints\":[{\"x\":0.08,\"y\":0.24,\"label\":1},{\"x\":0.2,\"y\":0.27,\"label\":1},{\"x\":0.05,\"y\":0.3,\"label\":1},{\"x\":0.1,\"y\":0.1,\"label\":1},{\"x\":0.4,\"y\":0.4,\"label\":0},{\"x\":0.6,\"y\":0.4,\"label\":0},{\"x\":0.65,\"y\":0.7,\"label\":0},{\"x\":0.7,\"y\":0.3,\"label\":0},{\"x\":0.35,\"y\":0.65,\"label\":0},{\"x\":0.3,\"y\":0.5,\"label\":0},{\"x\":0.7,\"y\":0.5,\"label\":0},{\"x\":0.75,\"y\":0.55,\"label\":0},{\"x\":0.7,\"y\":0.6,\"label\":0},{\"x\":0.65,\"y\":0.34,\"label\":0},{\"x\":0.8,\"y\":0.65,\"label\":0},{\"x\":0.5,\"y\":0.7,\"label\":0},{\"x\":0.5,\"y\":0.66,\"label\":0},{\"x\":0.56,\"y\":0.66,\"label\":0},{\"x\":0.46,\"y\":0.36,\"label\":0},{\"x\":0.46,\"y\":0.26,\"label\":0},{\"x\":0.36,\"y\":0.26,\"label\":0},{\"x\":0.26,\"y\":0.36,\"label\":0},{\"x\":0.56,\"y\":0.28,\"label\":0},{\"x\":0.33,\"y\":0.54,\"label\":0},{\"x\":0.23,\"y\":0.52,\"label\":0},{\"x\":0.26,\"y\":0.16,\"label\":1},{\"x\":0.06,\"y\":0.46,\"label\":1},{\"x\":0.13,\"y\":0.66,\"label\":1},{\"x\":0.2,\"y\":0.8,\"label\":1},{\"x\":0.5,\"y\":0.5,\"label\":1},{\"x\":0.45,\"y\":0.5,\"label\":1},{\"x\":0.5,\"y\":0.45,\"label\":1},{\"x\":0.45,\"y\":0.45,\"label\":1},{\"x\":0.55,\"y\":0.55,\"label\":1},{\"x\":0.5,\"y\":0.55,\"label\":1},{\"x\":0.5,\"y\":0.2,\"label\":1},{\"x\":0.4,\"y\":0.1,\"label\":1},{\"x\":0.6,\"y\":0.1,\"label\":1},{\"x\":0.75,\"y\":0.15,\"label\":1},{\"x\":0.88,\"y\":0.22,\"label\":1},{\"x\":0.9,\"y\":0.35,\"label\":1},{\"x\":0.9,\"y\":0.49,\"label\":1},{\"x\":0.88,\"y\":0.62,\"label\":1},{\"x\":0.9,\"y\":0.9,\"label\":1},{\"x\":0.9,\"y\":0.8,\"label\":1},{\"x\":0.75,\"y\":0.85,\"label\":1},{\"x\":0.55,\"y\":0.92,\"label\":1},{\"x\":0.6,\"y\":0.95,\"label\":1},{\"x\":0.06,\"y\":0.57,\"label\":1},{\"x\":0.09,\"y\":0.8,\"label\":1},{\"x\":0.4,\"y\":0.9,\"label\":1}],\"neuralNet\":{\"layers\":[{\"neurons\":[{\"bias\":0.5},{\"bias\":0.5}]},{\"neurons\":[{\"bias\":0.5},{\"bias\":0.5},{\"bias\":0.5},{\"bias\":0.5},{\"bias\":0.5}]},{\"neurons\":[{\"bias\":0.5},{\"bias\":0.5},{\"bias\":0.5},{\"bias\":0.5},{\"bias\":0.5}]},{\"neurons\":[{\"bias\":0.5},{\"bias\":0.5}]},{\"neurons\":[{\"bias\":0.5}]}],\"links\":[{\"n0\":[0,0],\"nf\":[1,0],\"weight\":2.2559318523672673},{\"n0\":[0,0],\"nf\":[1,1],\"weight\":3.7705902078344162},{\"n0\":[0,0],\"nf\":[1,2],\"weight\":-5.673868837964195},{\"n0\":[0,0],\"nf\":[1,3],\"weight\":-2.552116396138559},{\"n0\":[0,0],\"nf\":[1,4],\"weight\":-4.765897189158554},{\"n0\":[0,1],\"nf\":[1,0],\"weight\":2.522847383501193},{\"n0\":[0,1],\"nf\":[1,1],\"weight\":-2.9902303588384505},{\"n0\":[0,1],\"nf\":[1,2],\"weight\":2.749623598598969},{\"n0\":[0,1],\"nf\":[1,3],\"weight\":-2.0657459601688077},{\"n0\":[0,1],\"nf\":[1,4],\"weight\":2.311040191441733},{\"n0\":[1,0],\"nf\":[2,0],\"weight\":-2.8083933750840506},{\"n0\":[1,0],\"nf\":[2,1],\"weight\":2.368208438212055},{\"n0\":[1,0],\"nf\":[2,2],\"weight\":2.792010178964303},{\"n0\":[1,0],\"nf\":[2,3],\"weight\":2.1204797088106764},{\"n0\":[1,0],\"nf\":[2,4],\"weight\":3.0855603411983634},{\"n0\":[1,1],\"nf\":[2,0],\"weight\":-2.1619760012233913},{\"n0\":[1,1],\"nf\":[2,1],\"weight\":2.7735676578848043},{\"n0\":[1,1],\"nf\":[2,2],\"weight\":-4.795321974592097},{\"n0\":[1,1],\"nf\":[2,3],\"weight\":-3.1618858651724424},{\"n0\":[1,1],\"nf\":[2,4],\"weight\":2.642537468325151},{\"n0\":[1,2],\"nf\":[2,0],\"weight\":5.111269168104936},{\"n0\":[1,2],\"nf\":[2,1],\"weight\":1.8060793114773712},{\"n0\":[1,2],\"nf\":[2,2],\"weight\":1.2874475479043777},{\"n0\":[1,2],\"nf\":[2,3],\"weight\":3.715659708889894},{\"n0\":[1,2],\"nf\":[2,4],\"weight\":-5.479057778095251},{\"n0\":[1,3],\"nf\":[2,0],\"weight\":4.279970838297447},{\"n0\":[1,3],\"nf\":[2,1],\"weight\":-3.8573191202934085},{\"n0\":[1,3],\"nf\":[2,2],\"weight\":-4.346636276004062},{\"n0\":[1,3],\"nf\":[2,3],\"weight\":1.8026421918582567},{\"n0\":[1,3],\"nf\":[2,4],\"weight\":3.9687935202147346},{\"n0\":[1,4],\"nf\":[2,0],\"weight\":-3.5216391228147197},{\"n0\":[1,4],\"nf\":[2,1],\"weight\":4.599458665307638},{\"n0\":[1,4],\"nf\":[2,2],\"weight\":-4.752572287153145},{\"n0\":[1,4],\"nf\":[2,3],\"weight\":-3.810827524569661},{\"n0\":[1,4],\"nf\":[2,4],\"weight\":3.0650028924296953},{\"n0\":[2,0],\"nf\":[3,0],\"weight\":-4.300364295192499},{\"n0\":[2,0],\"nf\":[3,1],\"weight\":-2.9036061692080217},{\"n0\":[2,1],\"nf\":[3,0],\"weight\":4.132576329093505},{\"n0\":[2,1],\"nf\":[3,1],\"weight\":-3.817976850598705},{\"n0\":[2,2],\"nf\":[3,0],\"weight\":4.606542085589321},{\"n0\":[2,2],\"nf\":[3,1],\"weight\":2.8220313920923323},{\"n0\":[2,3],\"nf\":[3,0],\"weight\":2.3423002019828885},{\"n0\":[2,3],\"nf\":[3,1],\"weight\":2.098573708791525},{\"n0\":[2,4],\"nf\":[3,0],\"weight\":4.4760505444141625},{\"n0\":[2,4],\"nf\":[3,1],\"weight\":3.95752484391276},{\"n0\":[3,0],\"nf\":[4,0],\"weight\":-0.7265226578414495},{\"n0\":[3,1],\"nf\":[4,0],\"weight\":-4.316679309853457}]}}","var NeuralNet = require(\"./NeuralNet\");\nvar DataCanvas = require(\"./DataCanvas\");\nvar ControlPanel = require(\"./ControlPanel\");\nvar svg = require(\"./svg\");\n\nwindow.neuralNet;\nwindow.dataCanvas;\nwindow.controllableParameters;\nwindow.controlPanel;\n\nfunction init() {\n\tvar data = require(\"./data\");\n\t\n\tcontrollableParameters = {\n\t\tlearningRate: 0.2,\n\t\tregularization: 0.000009\n\t};\n\t\n\tvar container = document.createElement(\"div\");\n\tcontainer.className = \"content-container\";\n\tdocument.body.appendChild(container);\n\t\n\tvar row;\n\t\n\trow = document.createElement(\"div\");\n\tcontainer.appendChild(row);\n\trow.className = \"content-container-row\";\n\t\n\tvar svgNeuralNet = svg.createElement(\"svg\");\n\tsvgNeuralNet.className = \"content-container-cell\";\n\tsvgNeuralNet.id = \"neural-net\";\n\trow.appendChild(svgNeuralNet);\n\t\n\tneuralNet = NeuralNet.newFromData(data.neuralNet);\n\tsvgNeuralNet.appendChild(neuralNet.svgElement);\n\t\n\tdataCanvas = DataCanvas.newFromData(data.dataPoints);\n\tdataCanvas.domElement.className += \" content-container-cell\";\n\tdataCanvas.domElement.id = \"data-canvas\";\n\trow.appendChild(dataCanvas.domElement);\n\t\n\trow = document.createElement(\"div\");\n\tcontainer.appendChild(row);\n\trow.className = \"content-container-row\";\n\t\n\tcontrolPanel = new ControlPanel(neuralNet, controllableParameters);\n\tcontrolPanel.domElement.className += \" content-container-cell\";\n\trow.appendChild(controlPanel.domElement);\n\t\n\tupdate();\n}\n\nfunction update() {\n\tfor (var i = 0; i < 10; i++) {\n\t\tvar dataError = 0;\n\t\tvar regularizationError;\n\t\t\n\t\tfor (var j = 0; j < dataCanvas.dataPoints.length; j++) {\n\t\t\tneuralNet.reset();\n\t\t\t\n\t\t\tvar dataPoint = dataCanvas.dataPoints[j];\n\t\t\tneuralNet.layers[0].neurons[0].activation = dataPoint.x;\n\t\t\tneuralNet.layers[0].neurons[1].activation = dataPoint.y;\n\t\t\tneuralNet.forward();\n\t\t\t\n\t\t\tvar neuron = neuralNet.layers[neuralNet.layers.length - 1].neurons[0];\n\t\t\tvar output = neuron.activation;\n\t\t\tvar d = dataPoint.label - output;\n\t\t\tdataError += 0.5 * d * d;\n\t\t\tneuron.dActivation = -d;\n\t\t\t\n\t\t\tregularizationError = neuralNet.backward(\n\t\t\t\tcontrollableParameters.learningRate,\n\t\t\t\tcontrollableParameters.regularization\n\t\t\t);\n\t\t}\n\t}\n\t\t\n\tneuralNet.redraw();\n\tdataCanvas.redraw(function(x, y) {\n\t\tneuralNet.layers[0].neurons[0].activation = x;\n\t\tneuralNet.layers[0].neurons[1].activation = y;\n\t\tneuralNet.forward();\n\t\treturn neuralNet.layers[neuralNet.layers.length - 1].neurons[0].activation;\n\t});\n\tcontrolPanel.update({\n\t\ttotalError: dataError + regularizationError,\n\t\tdataError: dataError,\n\t\tregularizationError: regularizationError\n\t});\n\t\n\trequestAnimationFrame(update);\n}\n\nfunction getData() {\n\treturn {\n\t\tdataPoints: dataCanvas.toData(),\n\t\tneuralNet: neuralNet.toData()\n\t}\n}\nwindow.getData = getData;\n\ninit();\n"]}